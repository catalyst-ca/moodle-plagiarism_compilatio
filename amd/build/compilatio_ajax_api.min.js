define(["jquery"],function(a){function c(){a(".cmp-btn-lg").each(function(){a(this).attr("disabled","disabled"),a(this).addClass("disabled"),a(this).attr("href","#")})}var t={};function o(c,t,o,s,n,e,p,r,m){a.post(c+"/plagiarism/compilatio/ajax/display_document_frame.php",{cantriggeranalysis:t,isstudentanalyse:o,cmpfileid:s,canviewreport:n,isteacher:e,url:p,filename:r},function(t){a("#cmp-"+m).empty().append(t),setTimeout(t=>{if(e){var o=a("#cmp-"+m+" .cmp-similarity");o.on("mouseover",a=>{o.find("i").removeClass("fa-circle").addClass("fa-refresh")}),o.on("mouseout",a=>{o.find("i").removeClass("fa-refresh").addClass("fa-circle")}),o.click(function(){o.empty(),a.post(c+"/plagiarism/compilatio/ajax/update_score.php",{docId:s},function(a){o.replaceWith(a)})})}var n=a("#cmp-"+m+" .cmp-library");n.click(function(){if((i=n.find("i")).is(".cmp-library-in"))var t=0;if(i.is(".cmp-library-out"))var t=1;i.removeClass(),a.post(c+"/plagiarism/compilatio/ajax/set_indexing_state.php",{docId:s,indexingState:t},function(a){"true"==a&&(0==t?i.addClass("cmp-library-out fa-times-circle fa"):i.addClass("cmp-library-in fa-check-circle fa"))})});var p=a("#cmp-"+m+" .cmp-start-btn");p.click(function(){p.find("i").removeClass("fa-play-circle").addClass("fa-spinner fa-spin"),a.post(c+"/plagiarism/compilatio/ajax/start_analysis.php",{docId:s},function(c){"error"in(c=JSON.parse(c))?(a("#cmp-"+m+" p").remove(),a("#cmp-"+m).append("<p class='cmp-color-red'>"+c.error+"</p>"),p.find("i").removeClass("fa-spinner fa-spin").addClass("fa-play-circle")):p.replaceWith(c.documentFrame)})})},500)})}return t.startAllAnalysis=function(t,o,s){a(document).ready(function(){a("button.cmp-start-btn").click(function(){c(),a("#cmp-stats, #cmp-help, #cmp-home, #cmp-search, #cmp-notifications").hide(),a("#cmp-tabs-separator").after("<div class='cmp-alert cmp-alert-info'>"+s+"</div>"),a.post(t+"/plagiarism/compilatio/ajax/start_all_analysis.php",{cmid:o},function(){window.location.reload()})})})},t.sendUnsentDocs=function(t,o,s){a(document).ready(function(){a("button.cmp-send-btn").click(function(){c(),a("#cmp-stats, #cmp-help, #cmp-home, #cmp-search, #cmp-notifications").hide(),a("#cmp-tabs-separator").after("<div class='cmp-alert cmp-alert-info'>"+s+"</div>"),a.post(t+"/plagiarism/compilatio/ajax/send_unsent_docs.php",{cmid:o},function(){window.location.reload()})})})},t.resetDocsInError=function(t,o,s){a(document).ready(function(){a("button.cmp-reset-btn").click(function(){c(),a("#cmp-stats, #cmp-help, #cmp-home, #cmp-search, #cmp-notifications").hide(),a("#cmp-tabs-separator").after("<div class='cmp-alert cmp-alert-info'>"+s+"</div>"),a.post(t+"/plagiarism/compilatio/ajax/reset_docs_in_error.php",{cmid:o},function(){window.location.reload()})})})},t.validateTermsOfService=function(c,t){a(document).ready(function(){a("#tos-btn").click(function(){a.post(c+"/plagiarism/compilatio/ajax/validate_terms_of_service.php",{userid:t},function(){window.location.reload()})})})},t.checkUserInfo=function(c,t){a(document).ready(function(){a.post(c+"/plagiarism/compilatio/ajax/check_user_info.php",{userid:t})})},t.displayDocumentFrame=function(c,t,s,n,e,p,r,m,l){a(document).ready(function(){o(c,t,s,n,e,p,r,m,l),setInterval(function(){o(c,t,s,n,e,p,r,m,l)},18e4)})},t.compilatioTabs=function(c,t){a(document).ready(function(){a("#cmp-tabs").show();var o="";a(o=t?"#cmp-search":c>0?"#cmp-notifications":"#cmp-home").show(),a("#cmp-show-notifications").on("click",function(){e(a(this),a("#cmp-notifications"))}),a("#show-stats").on("click",function(){e(a(this),a("#cmp-stats"))}),a("#show-help").on("click",function(){e(a(this),a("#cmp-help"))}),a("#show-search").on("click",function(){e(a(this),a("#cmp-search"))});var s=a("#cmp-show-notifications, #show-stats, #show-help, #show-search"),n=a("#cmp-notifications, #cmp-stats, #cmp-help, #cmp-home, #cmp-search");function e(c,t){t.is(":visible")||(t.show(),n.not(t).hide(),s.not(c).removeClass("active"),c.toggleClass("active"),a("#cmp-hide-area").fadeIn(),a("#cmp-tabs-separator").show())}a("#cmp-logo").on("click",function(){var c=a("#cmp-home");c.show(),n.not(c).hide(),s.removeClass("active"),a("#cmp-hide-area").fadeIn(),a("#cmp-tabs-separator").show()}),a("#cmp-hide-area").on("click",function(){n.hide(),a(this).fadeOut(),s.removeClass("active"),a("#cmp-tabs-separator").hide()})})},t});