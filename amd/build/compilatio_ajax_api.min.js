define(["jquery"],function(i){function o(){i(".compilatio-button").each(function(){i(this).attr("disabled","disabled"),i(this).addClass("disabled"),i(this).attr("href","#")})}var t={toggleIndexingState:function(o,t,a){i(document).ready(function(){setTimeout(function(){var c=i(".compi-"+t+" > div:first-child");c.click(function(){if(c.is(".compilatio-library-in"))var t=0;if(c.is(".compilatio-library-out"))t=1;i.post(o+"/plagiarism/compilatio/ajax/set_indexing_state.php",{idDoc:a,indexingState:t},function(i){"true"==i&&(0==t?(c.removeClass("compilatio-library-in"),c.addClass("compilatio-library-out")):(c.removeClass("compilatio-library-out"),c.addClass("compilatio-library-in")))})})},300)})},refreshButton:function(t,a,c,n){i(document).ready(function(){var s=a.length,e=0,l=i("i.fa-refresh").parent("button");0==s?(o(),c>0&&i(".comp-start-btn").each(function(){i(this).removeAttr("disabled"),i(this).removeClass("disabled")})):l.click(function(){o(),i("#compi-home").html("<p>"+n+"<progress id='compi-update-progress' value='"+e+"' max='"+s+"'></progress></p>"),i("#compilatio-logo").click(),a.forEach(function(o){i.post(t+"/plagiarism/compilatio/ajax/check_analysis.php",{id:o},function(){e++,i("#compi-update-progress").val(e),e==s&&window.location.reload()})})})})},startAllAnalysis:function(t,a,c,n){i(document).ready(function(){i("button.comp-start-btn").click(function(){o(),i("#compi-notifications").show(),i("#compi-stats, #compi-help, #compi-home, #compi-search").hide(),i("#compi-notif-title").after("<div class='compilatio-alert compilatio-alert-info'><strong>"+c+"</strong><br/>"+n+"</div>"),i.post(t+"/plagiarism/compilatio/ajax/start_all_analysis.php",{cmid:a},function(){window.location.reload()})})})},startAnalysis:function(o,t,a){i(document).ready(function(){setTimeout(function(){i(".compi-"+t+" > div:last-child").click(function(){i.post(o+"/plagiarism/compilatio/ajax/start_analysis.php",{docId:a},function(){window.location.reload()})})},300)})},restartFailedAnalysis:function(t,a,c,n){i(document).ready(function(){i("button.comp-restart-btn").click(function(){o(),i("#compi-notifications").show(),i("#compi-stats, #compi-help, #compi-home, #compi-search").hide(),i("#compi-notif-title").after("<div class='compilatio-alert compilatio-alert-info'><strong>"+c+"</strong><br/>"+n+"</div>"),i.post(t+"/plagiarism/compilatio/ajax/restart_failed_analysis.php",{cmid:a},function(){window.location.reload()})})})},validateTermsOfService:function(o,t){i(document).ready(function(){i("#tos-btn").click(function(){i.post(o+"/plagiarism/compilatio/ajax/validate_terms_of_service.php",{userid:t},function(){window.location.reload()})})})},compilatioTabs:function(o,t,a,c,n){i(document).ready(function(){i("#compilatio-tabs").show();i(a?"#compi-search":t>0?"#compi-notifications":"#compi-home").show(),i("#compilatio-show-notifications").on("click",function(){n(i(this),i("#compi-notifications"))}),i("#show-stats").on("click",function(){n(i(this),i("#compi-stats"))}),i("#show-help").on("click",function(){n(i(this),i("#compi-help"))}),i("#show-search").on("click",function(){n(i(this),i("#compi-search"))});var o=i("#compilatio-show-notifications, #show-stats, #show-help, #show-search"),c=i("#compi-notifications, #compi-stats, #compi-help, #compi-home, #compi-search");function n(t,a){a.is(":visible")||(a.show(),c.not(a).hide(),o.not(t).removeClass("active"),t.toggleClass("active"),i("#compilatio-hide-area").fadeIn())}i("#compilatio-logo").on("click",function(){var t=i("#compi-home");t.show(),c.not(t).hide(),o.removeClass("active"),i("#compilatio-hide-area").fadeIn()}),i("#compilatio-hide-area").on("click",function(){c.hide(),i(this).fadeOut(),o.removeClass("active")})})}};return t});